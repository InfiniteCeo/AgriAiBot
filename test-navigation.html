<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigation Test - AgriAI Bot</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="max-w-4xl mx-auto p-6">
        <h1 class="text-3xl font-bold text-gray-800 mb-8">üß™ AgriAI Bot Navigation Test</h1>
        
        <!-- Navigation Test Section -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">
                <i class="fas fa-compass mr-2 text-blue-600"></i>Navigation Test
            </h2>
            <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                <button onclick="testNavigation('welcome')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-home mr-2"></i>Welcome
                </button>
                <button onclick="testNavigation('login')" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-sign-in-alt mr-2"></i>Login
                </button>
                <button onclick="testNavigation('dashboard')" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-tachometer-alt mr-2"></i>Dashboard
                </button>
                <button onclick="testNavigation('chat')" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-comments mr-2"></i>AI Chat
                </button>
                <button onclick="testNavigation('marketplace')" class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-store mr-2"></i>Marketplace
                </button>
                <button onclick="testNavigation('profile')" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-user mr-2"></i>Profile
                </button>
                <button onclick="testNavigation('sacco')" class="bg-pink-600 hover:bg-pink-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-users mr-2"></i>SACCO
                </button>
                <button onclick="testNavigation('wholesaler')" class="bg-teal-600 hover:bg-teal-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-warehouse mr-2"></i>Wholesaler
                </button>
                <button onclick="testNavigation('recommendations')" class="bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-lightbulb mr-2"></i>Recommendations
                </button>
            </div>
        </div>

        <!-- API Test Section -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">
                <i class="fas fa-robot mr-2 text-green-600"></i>AI API Test
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <button onclick="testAPI('/api/marketplace/ai/dashboard-insights')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-chart-line mr-2"></i>Dashboard Insights
                </button>
                <button onclick="testAPI('/api/marketplace/ai/product-optimizations')" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-magic mr-2"></i>Product Optimizations
                </button>
                <button onclick="testAPI('/api/marketplace/ai/competitive-analysis')" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-trophy mr-2"></i>Competitive Analysis
                </button>
                <button onclick="testAPI('/api/marketplace/ai/sales-insights')" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-chart-bar mr-2"></i>Sales Insights
                </button>
                <button onclick="testAPI('/api/marketplace/ai/inventory-recommendations')" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-warehouse mr-2"></i>Inventory Recommendations
                </button>
                <button onclick="testAPI('/api/marketplace/products')" class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-boxes mr-2"></i>Products API
                </button>
            </div>
        </div>

        <!-- Wholesaler Features Test -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">
                <i class="fas fa-warehouse mr-2 text-teal-600"></i>Wholesaler Features Test
            </h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <button onclick="testWholesalerTab('products')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-boxes mr-2"></i>Products Tab
                </button>
                <button onclick="testWholesalerTab('orders')" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-shopping-cart mr-2"></i>Orders Tab
                </button>
                <button onclick="testWholesalerTab('aiInsights')" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-brain mr-2"></i>AI Insights Tab
                </button>
                <button onclick="testWholesalerTab('analytics')" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg transition-colors">
                    <i class="fas fa-chart-bar mr-2"></i>Analytics Tab
                </button>
            </div>
        </div>

        <!-- Test Results -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">
                <i class="fas fa-clipboard-check mr-2 text-green-600"></i>Test Results
            </h2>
            <div id="testResults" class="space-y-2">
                <p class="text-gray-600">Click buttons above to test functionality...</p>
            </div>
        </div>
    </div>

    <script>
        // Test navigation functionality
        function testNavigation(page) {
            addTestResult(`üß≠ Testing navigation to: ${page}`, 'info');
            
            try {
                // Check if navigateTo function exists
                if (typeof window.navigateTo === 'function') {
                    window.navigateTo(page);
                    addTestResult(`‚úÖ Navigation to ${page} successful`, 'success');
                } else if (typeof window.agriApp !== 'undefined' && window.agriApp.navigateTo) {
                    window.agriApp.navigateTo(page);
                    addTestResult(`‚úÖ Navigation to ${page} successful (via agriApp)`, 'success');
                } else {
                    // Fallback: redirect to page
                    if (page === 'welcome') {
                        window.location.href = 'index.html';
                    } else {
                        window.location.href = `${page}.html`;
                    }
                    addTestResult(`‚ö†Ô∏è Navigation to ${page} via fallback redirect`, 'warning');
                }
            } catch (error) {
                addTestResult(`‚ùå Navigation to ${page} failed: ${error.message}`, 'error');
            }
        }

        // Test API endpoints
        async function testAPI(endpoint) {
            addTestResult(`üîå Testing API: ${endpoint}`, 'info');
            
            try {
                const token = localStorage.getItem('authToken') || localStorage.getItem('token');
                const headers = {
                    'Content-Type': 'application/json'
                };
                
                if (token) {
                    headers['Authorization'] = `Bearer ${token}`;
                }
                
                const response = await fetch(endpoint, { headers });
                
                if (response.ok) {
                    const data = await response.json();
                    addTestResult(`‚úÖ API ${endpoint} successful (${response.status})`, 'success');
                    console.log(`API Response for ${endpoint}:`, data);
                } else {
                    addTestResult(`‚ö†Ô∏è API ${endpoint} returned ${response.status}: ${response.statusText}`, 'warning');
                }
            } catch (error) {
                addTestResult(`‚ùå API ${endpoint} failed: ${error.message}`, 'error');
            }
        }

        // Test wholesaler tab functionality
        function testWholesalerTab(tabName) {
            addTestResult(`üìã Testing wholesaler tab: ${tabName}`, 'info');
            
            try {
                // Check if we're on wholesaler page
                if (window.location.pathname.includes('wholesaler') || document.getElementById(`${tabName}Tab`)) {
                    const tabButton = document.getElementById(`${tabName}Tab`);
                    const tabContent = document.getElementById(`${tabName}Content`);
                    
                    if (tabButton && tabContent) {
                        tabButton.click();
                        addTestResult(`‚úÖ Wholesaler ${tabName} tab activated`, 'success');
                    } else {
                        addTestResult(`‚ö†Ô∏è Wholesaler ${tabName} tab elements not found`, 'warning');
                    }
                } else {
                    // Navigate to wholesaler page first
                    testNavigation('wholesaler');
                    setTimeout(() => {
                        testWholesalerTab(tabName);
                    }, 1000);
                }
            } catch (error) {
                addTestResult(`‚ùå Wholesaler ${tabName} tab test failed: ${error.message}`, 'error');
            }
        }

        // Add test result to display
        function addTestResult(message, type) {
            const resultsContainer = document.getElementById('testResults');
            const resultDiv = document.createElement('div');
            
            const colors = {
                'success': 'text-green-700 bg-green-50 border-green-200',
                'error': 'text-red-700 bg-red-50 border-red-200',
                'warning': 'text-yellow-700 bg-yellow-50 border-yellow-200',
                'info': 'text-blue-700 bg-blue-50 border-blue-200'
            };
            
            resultDiv.className = `p-3 rounded-lg border ${colors[type] || colors.info}`;
            resultDiv.innerHTML = `
                <div class="flex items-center">
                    <span class="text-sm font-mono">${new Date().toLocaleTimeString()}</span>
                    <span class="ml-3">${message}</span>
                </div>
            `;
            
            resultsContainer.appendChild(resultDiv);
            resultDiv.scrollIntoView({ behavior: 'smooth' });
        }

        // Initialize test page
        document.addEventListener('DOMContentLoaded', function() {
            addTestResult('üöÄ Navigation test page loaded', 'success');
            
            // Check if main app is loaded
            if (typeof window.agriApp !== 'undefined') {
                addTestResult('‚úÖ Main AgriAI app detected', 'success');
            } else if (typeof window.navigateTo === 'function') {
                addTestResult('‚úÖ Navigation function detected', 'success');
            } else {
                addTestResult('‚ö†Ô∏è Main app not detected - using fallback navigation', 'warning');
            }
            
            // Check authentication status
            const token = localStorage.getItem('authToken') || localStorage.getItem('token');
            if (token) {
                addTestResult('‚úÖ Authentication token found', 'success');
            } else {
                addTestResult('‚ö†Ô∏è No authentication token - some features may not work', 'warning');
            }
        });

        // Auto-test basic functionality
        setTimeout(() => {
            addTestResult('üîÑ Running automatic tests...', 'info');
            
            // Test basic API endpoint
            testAPI('/api/debug/health');
            
            // Test if we can access main elements
            const mainNav = document.getElementById('mainNav');
            if (mainNav) {
                addTestResult('‚úÖ Main navigation found', 'success');
            } else {
                addTestResult('‚ö†Ô∏è Main navigation not found', 'warning');
            }
        }, 2000);
    </script>
</body>
</html>